<head>
    <script src="https://api-maps.yandex.ru/2.1/?apikey=d14ef91a-a8fe-4afe-afd5-c31f8b9c3066&lang=ru_RU" type="text/javascript">
    </script>
</head>
<body>
	<input type="text" name="ym-address" id="ym-address" placeholder="Адрес">
	<button id="ym-address-calc">Рассчитать</button>
	<br><br>
    <div id="map" style="width: 100%; height: 600px"></div>
</body>

<script>
	var a107 = {"type":"Polygon","coordinates":[[[37.49544995150958,56.13916728548688],[37.48446362338457,56.15334986376711],[37.488497665742884,56.158858569638824],[37.497595718721406,56.16163657259955],[37.50351803622629,56.16676097973253],[37.50823872409249,56.17312961289244],[37.51404287840026,56.178524455691075],[37.518334412824096,56.18546551436722],[37.5234842541327,56.19259673750362],[37.52417089964051,56.19982232409776],[37.52374174619812,56.20508513608485],[37.52382757688659,56.20575489649942],[37.52494337583679,56.20632896750582],[37.528805756818244,56.20613761146254],[37.542796159039916,56.20565921715933],[37.554469132672736,56.20087494450984],[37.56511213804382,56.19632933034644],[37.58159163023132,56.19221388683423],[37.60150434995788,56.185800568051995],[37.604079270612175,56.18589629714057],[37.60905745054383,56.18508259224441],[37.618498826276216,56.18335939526737],[37.720809006940236,56.158412206270796],[37.7226972820867,56.15759791629199],[37.724499726544714,56.1575021163315],[37.72724630857596,56.15745421626129],[37.73059370542654,56.156879410741006],[37.814621949445076,56.1460522937884],[37.82088758970385,56.14518982532641],[37.826809907208734,56.14447108676238],[37.837109589825936,56.14322524127338],[37.845263505231195,56.142123113391655],[37.85333158994801,56.14030213693319],[37.863373780499764,56.13804975675215],[37.86929609800465,56.13555760723936],[37.87453177000172,56.13325701756248],[37.87727835203296,56.132250466113945],[37.881827378522225,56.13124388820796],[37.93392660642749,56.1206492496429],[37.93693068052418,56.11983415606287],[37.94165136839039,56.117244920248346],[37.94817450071461,56.113456648891464],[37.949032807599366,56.111922052652595],[37.95203688169606,56.11110677340573],[37.95615675474293,56.108708792745496],[37.98619749570973,56.091966708862444],[38.00259115720873,56.083616921416116],[38.00756933714038,56.08232110183165],[38.01752569700366,56.08020930207296],[38.0316877606023,56.077713388861405],[38.04378988767749,56.07608135782621],[38.07297232175949,56.07233702434746],[38.0798387768376,56.071424887784524],[38.088850999127644,56.0685443142184],[38.13691618467452,56.05284138838261],[38.164038682233105,56.043906583407704],[38.16996099973799,56.04270551032754],[38.17356588865402,56.04232115901228],[38.1820631268132,56.04198484845755],[38.19004538084152,56.04102394493846],[38.19184782529953,56.04015911122579],[38.19991591001632,56.037996941786865],[38.214249634991916,56.03045242018035],[38.2197427990544,56.027664897459694],[38.240513825665744,56.02059906381697],[38.27802183653,56.00805040443217],[38.28171255613447,56.00675203358588],[38.2842016461003,56.00607878700825],[38.28857901121261,56.00458798480571],[38.29578878904465,56.00189477634235],[38.299307847272175,56.001077157904525],[38.30342772031904,56.00093287049458],[38.30823423887375,56.00117334921062],[38.31269743467451,56.00050000501879],[38.31681730772141,55.99828750543614],[38.32522871519206,55.992755699977906],[38.3320093395817,55.9883777948015],[38.33904745603679,55.984913604952894],[38.34299566770671,55.9829408020138],[38.344025635968414,55.981882183160316],[38.36170675779459,55.96373678296953],[38.364110017071944,55.96229248478271],[38.36471083189128,55.96065554806834],[38.36625578428385,55.959211134404974],[38.36797239805339,55.95805556449972],[38.37209227110026,55.95685180900839],[38.385911011944984,55.95246982154704],[38.38754179502605,55.95116957560256],[38.39200499082681,55.948761596947286],[38.39835646177409,55.94341534680251],[38.39981558347819,55.940717858222136],[38.40067389036292,55.937201205899036],[38.40161802793615,55.93517778118618],[38.40213301206701,55.93103424704065],[38.40342047239417,55.9294441681205],[38.40221884275549,55.92862501098262],[38.40221884275549,55.927805836454866],[38.40307714964027,55.92717939714103],[38.40445044065589,55.9262156244931],[38.404793763409785,55.92419162358458],[38.40410711790197,55.91995051556325],[38.40659620786775,55.905151182827645],[38.41552259946932,55.900136441710295],[38.42513563657871,55.89473522312799],[38.42479231382479,55.88431645463715],[38.4280538799869,55.88118062721952],[38.43732359434237,55.869889541999626],[38.440585160504476,55.866704280748024],[38.440928483258396,55.8633739543837],[38.43955519224277,55.85960889233688],[38.44642164732081,55.851981105178105],[38.4302854778872,55.84773206538805],[38.42916967893703,55.844303522785545],[38.427367234479014,55.83498214678386],[38.424963975201656,55.82590009928582],[38.424620652447764,55.82266289737636],[38.42753889585596,55.80526434443997],[38.430628800641124,55.79085629914806],[38.435006165753435,55.76923419185721],[38.43577864194972,55.76216932699044],[38.44247343565089,55.75413511046033],[38.45294477964503,55.74803574002105],[38.45732214475729,55.737722721401944],[38.432774567853,55.734332868843246],[38.42728140379049,55.7306521227269],[38.42041494871238,55.723774005188105],[38.41784002805807,55.72164251055726],[38.424534821759245,55.713599910687044],[38.43380453611471,55.70225992704223],[38.435006165753386,55.69906087250422],[38.43380453611471,55.69683107291956],[38.43191626096822,55.6945041893275],[38.42865469480611,55.69304981644518],[38.39226248289206,55.668802267824006],[38.358101868878386,55.630654595464904],[38.36084845090955,55.63036324828252],[38.36531164671034,55.626964037365305],[38.36565496946423,55.6252157564486],[38.37440969968886,55.60996354079195],[38.387627625714195,55.57992743997571],[38.3986139538392,55.55580408994487],[38.40513708616343,55.541887490846705],[38.40548040891732,55.53818854136355],[38.40427877927867,55.535852182677104],[38.40239050413218,55.53351568457973],[38.399300599347015,55.53001067602824],[38.37904455686652,55.503420817338984],[38.373551392803996,55.495333144012996],[38.369088197003215,55.49211709955136],[38.364281678448535,55.490557710333235],[38.35072042966925,55.486074120965],[38.34848883176885,55.48422205406314],[38.346600556622356,55.481297559879984],[38.345398926983684,55.47613042073058],[38.33870413328251,55.46910982088453],[38.33029272581181,55.45808884722049],[38.32273962522588,55.44891860037667],[38.31930639768682,55.442966549940344],[38.31810476804815,55.43779436416452],[38.31587317014777,55.43340235127139],[38.31295492673955,55.431743018670275],[38.30711843992314,55.429986001918984],[38.30042364622197,55.428521761302186],[38.29647543455205,55.427057466147176],[38.29390051389775,55.42412871221827],[38.29287054563605,55.42168791729003],[38.29201223875126,55.41934461161915],[38.28566076780402,55.417098812655254],[38.27999594236455,55.414950537121804],[38.275704407940715,55.41465758136684],[38.26282980466912,55.414266970276046],[38.253216767559756,55.41543879184132],[38.246865296612484,55.415731741777805],[38.243947053204266,55.41485288542255],[38.24068548704218,55.413485736504086],[38.23605062986442,55.410946619585026],[38.230729127178876,55.40782132761311],[38.22935583616325,55.40469578736131],[38.22609427000114,55.39951856514786],[38.22248938108514,55.39697854672753],[38.20721151853627,55.392875093754775],[38.19674017454212,55.38847806228969],[38.19193365598744,55.38623050099926],[38.18747046018666,55.38232139316176],[38.18335058713974,55.380659904812966],[38.17493917966903,55.37762995149315],[38.167729401837,55.3761637613651],[38.15760138059677,55.374990769967056],[38.12120916868272,55.37244916877444],[38.081898713360445,55.36932081911649],[38.046879792462015,55.3661922210421],[38.007397675762796,55.36296559409637],[37.99915792966904,55.36237890626673],[37.99538137937606,55.36277003245693],[37.98782827879014,55.36492115711714],[37.98113348508897,55.36726770464781],[37.976326966534266,55.36844092601229],[37.97272207761826,55.36902752359456],[37.96860220457139,55.36844092601229],[37.96122076536239,55.366974393848324],[37.903542542706155,55.352795101977584],[37.871441865215914,55.34565463128466],[37.86097052122177,55.34291547748385],[37.85667898679793,55.34320896734844],[37.84826757932725,55.34379594052541],[37.84174444700303,55.343013307681375],[37.81736853147564,55.339882620985485],[37.80792715574322,55.339393428741964],[37.79676916624127,55.337827972791004],[37.76655676389752,55.334501172598976],[37.746987366924856,55.333816208321295],[37.73153784299909,55.33264195617674],[37.70750525022564,55.331663386019095],[37.679867768536184,55.33156552766899],[37.610859895001,55.331174091835685],[37.60639669920022,55.33205481698662],[37.60107519651467,55.33107623227201],[37.595753693829124,55.33166338601333],[37.58270742918069,55.33136981023488],[37.55112173582131,55.3323483876681],[37.518506074200204,55.33313123213372],[37.48108389402442,55.33410976587921],[37.4771356823545,55.33420761791888],[37.4719858410459,55.335186124966846],[37.46735098386817,55.33782797276791],[37.442288422833016,55.353773147919256],[37.418942475567405,55.37127606671647],[37.41499426389748,55.372155896500146],[37.40623953367285,55.37381774359282],[37.39216330076271,55.37704348194497],[37.36933233762794,55.384178267719165],[37.34598639036232,55.39004150745577],[37.328476929913094,55.39062778341051],[37.256379151592796,55.39453606666233],[37.22513678098732,55.40098388575541],[37.200417542706084,55.407821327543715],[37.19011786008888,55.41778233017091],[37.174668336163094,55.425202613897184],[37.139649415264664,55.443942357616564],[37.10772039915139,55.45701584374762],[37.07270147825294,55.47262027768374],[37.05210211301852,55.48081012288472],[37.00300695920994,55.510240449863225],[36.98515417600682,55.52192848857231],[36.97725775266698,55.52835542394128],[36.98687078977633,55.536338935450374],[36.9899606945615,55.53945401066193],[36.987557435284145,55.542763506527116],[36.98343756223728,55.54879774936379],[36.99545385862399,55.564754810591474],[36.999230408916965,55.57623208533463],[37.001633668194316,55.58303904643203],[37.00060369993259,55.5877059918988],[37.00304987455418,55.58875111684702],[37.003564858685046,55.590792675664666],[37.004508996258274,55.593320172146434],[37.00579645658542,55.59397632238663],[37.008028054485806,55.59482687111326],[37.00875761533788,55.59555589814215],[37.00828554655125,55.59677091296142],[37.006011033306606,55.60141192171513],[37.003994012127336,55.60525066408172],[37.00141909147303,55.60836025471134],[37.02013018156094,55.62371022940799],[37.02073099638028,55.626964037206875],[37.02167513395351,55.629683429622936],[36.98322298551602,55.629877664681096],[36.983566308269914,55.63900562212788],[36.97326662565272,55.647549008577045],[36.970434212933,55.65206265593605],[36.96682932401694,55.661088383220886],[36.963052773723966,55.66550343474273],[36.96288111234702,55.6667162734056],[36.95867540861168,55.66778354020333],[36.949319863567716,55.671324716063424],[36.94047930265464,55.67321644523847],[36.92691805387533,55.676999628021726],[36.916017556438824,55.678891081628656],[36.90408709074059,55.68311014717112],[36.895418191204435,55.690189391028845],[36.88872339750324,55.69600698398461],[36.88194277311357,55.70036960817995],[36.88108446622881,55.701823707579344],[36.87602045560869,55.7067187762009],[36.87310221220045,55.71156477213598],[36.8714714291194,55.7163132625507],[36.872072243938746,55.71936555743669],[36.87644960905106,55.72314425732135],[36.87902452970533,55.725420988941806],[36.879797005901644,55.73036152240685],[36.87722208524734,55.73447815404657],[36.87713625455887,55.73825538538166],[36.88074114347482,55.742661691308925],[36.88880922819164,55.75079509737593],[36.89327242399242,55.756119619428645],[36.90760614896799,55.77300804454624],[36.90958025480295,55.77479807727231],[36.914815926800024,55.78103835650605],[36.921253228435766,55.7884866781901],[36.92193987394358,55.790904656946275],[36.922111535320525,55.79254879639747],[36.922025704632055,55.79399944980495],[36.92159655118969,55.79525663886773],[36.92133905912424,55.79656213822008],[36.920909905681874,55.7986411760871],[36.92099573637035,55.80047837258638],[36.920051598797095,55.80608611819565],[36.91799166227366,55.81783074920647],[36.91756250883127,55.819473747095],[36.91799166227366,55.822034751917464],[36.91842081571605,55.82362925430965],[36.91996576810862,55.829765060343796],[36.92520144010569,55.84734576557963],[36.92777636075999,55.85101545494916],[36.93584444547678,55.8586434324348],[36.94013597990062,55.863036078817],[36.943298631946014,55.876751618905686],[36.944843584338614,55.900290929253],[36.94621687535418,55.91726120409045],[36.946045213977236,55.92237010999425],[36.94827681187762,55.92680370663755],[36.95308333043232,55.931718620597415],[36.96517813867929,55.94308993234042],[36.99642050928472,55.973712717191106],[37.006376869148,55.9802578285242],[37.02354300684331,55.99295986999559],[37.027575993786186,56.01115189057151],[37.03100922132526,56.017690639253104],[37.048175359020576,56.02538186172034],[37.075984502086975,56.03422486589637],[37.106196904430725,56.044987516872965],[37.134692693004936,56.054786594396006],[37.14052917982132,56.05882078212791],[37.14344742322951,56.0610298005975],[37.13040115858107,56.07293710214411],[37.13383438612013,56.07480928527227],[37.15941193128612,56.0894955528417],[37.178638005504865,56.100530550263926],[37.18447449232127,56.104272132725036],[37.187049412975576,56.10676631816727],[37.18928101087595,56.108205197486086],[37.19494583631542,56.10973994255751],[37.20936539197948,56.11232968551357],[37.21674683118846,56.114727439627195],[37.22361328626658,56.11587830831281],[37.26343872571966,56.11952249778033],[37.2790599110224,56.12067322244897],[37.292621159801705,56.12172802303295],[37.31768372083686,56.123837537076255],[37.34223129774115,56.12585105575456],[37.352530980358345,56.128727327410424],[37.36763718153022,56.13265788270407],[37.37570526624701,56.13438336491009],[37.38445999647161,56.13447922275329],[37.43921997571968,56.136492182028256],[37.478873753795845,56.13812164296763],[37.49544995150958,56.13916728548688]]]};
	var mkad = {"type":"Polygon","coordinates":[[[37.39537712132244,55.83140488639904],[37.39561852013368,55.83212345470862],[37.395827732436864,55.832983907615116],[37.39620288223084,55.83548713647611],[37.39597447466585,55.837155594478716],[37.39571698260056,55.83852005639078],[37.395234184977625,55.83938942296994],[37.39455826830599,55.84086850875249],[37.39354975771652,55.84222076631033],[37.392594891307134,55.84353675732427],[37.392112093684325,55.844484484594936],[37.39185460161898,55.846059954409824],[37.39189751696327,55.84722491575294],[37.39238031458585,55.84880630975421],[37.393614130732836,55.851111890580555],[37.39529855799402,55.85430447072859],[37.39659674715727,55.85656144785314],[37.39768035959934,55.85870364392592],[37.399042921778786,55.86067073923611],[37.401006298777716,55.862885110284815],[37.4023366744491,55.8641702320847],[37.40328081202223,55.86502695623174],[37.40647800516785,55.86734966918456],[37.40861304354403,55.868652740569466],[37.40966446947779,55.869262032032516],[37.41394527506548,55.87133113831217],[37.41792567324361,55.87288741935852],[37.42185242724135,55.87414204994866],[37.4291265780898,55.8763435869575],[37.432549076792704,55.87745938661689],[37.43900783610063,55.87944362104462],[37.442644911524944,55.88056536201458],[37.44436152529436,55.88099354487618],[37.44612105440806,55.881325232565345],[37.450873928782734,55.881988599399],[37.454317885157714,55.882211729323124],[37.459746676203835,55.882272034486874],[37.4629224116773,55.88237455304298],[37.466001587626636,55.88271225932574],[37.46867306780551,55.883206752488164],[37.47082956385345,55.88370726961275],[37.47442372393332,55.884629892622016],[37.47734196734136,55.885317322903795],[37.48152621340467,55.88636653501212],[37.483511048075684,55.88686701122005],[37.48513110232065,55.88729512427877],[37.48656876635264,55.88769308427762],[37.48806007456502,55.888121188185515],[37.48999126505572,55.88882061534675],[37.49176152300537,55.88954414737184],[37.49348886561102,55.89027972437692],[37.497372704264826,55.8919859679395],[37.50002272677121,55.89318571953945],[37.50255473208136,55.8943010330846],[37.50589140009599,55.89575390677615],[37.50971086573305,55.89742373975836],[37.51298316073126,55.89888855186325],[37.51746406526784,55.90085184439739],[37.52014627428269,55.90203323842269],[37.52331128092035,55.90341952206193],[37.525188827230885,55.90412469943265],[37.52685179681998,55.9046550807663],[37.528686427786106,55.90520956255501],[37.53020992250667,55.905571176823976],[37.531679773046925,55.90585443896986],[37.534930610372804,55.90637274304294],[37.53796687097783,55.90672831972565],[37.54116406412329,55.907107999688044],[37.54380335779411,55.90742138351144],[37.55044450731499,55.908066222987465],[37.555444144918596,55.90860257659734],[37.558469676687466,55.90892800099913],[37.56616225214206,55.90972347131844],[37.57035722704147,55.9102055665711],[37.57414450617042,55.91051289915305],[37.57640829057919,55.910567134060926],[37.57795324297173,55.91056110796364],[37.581053876592826,55.9104405858181],[37.58356442423068,55.910187488101286],[37.58648266763892,55.9097777073283],[37.589411639883316,55.909175080644694],[37.5933276650449,55.90809635539087],[37.59979715318896,55.90627631487131],[37.60492553682553,55.90483589088119],[37.60786523790565,55.90401018428615],[37.609925174429286,55.90344363086377],[37.612328433706516,55.90282282342266],[37.61669506998275,55.90176200314244],[37.61997809381712,55.901002534369546],[37.622853421881,55.90039977074701],[37.62539615602704,55.89987535874415],[37.63114681215512,55.89878431784946],[37.633603715612765,55.89838647206878],[37.63725151987298,55.89778366762427],[37.64155378313277,55.89716879739417],[37.64430036516404,55.89683121742401],[37.64640321703174,55.89655994566743],[37.648162746145516,55.896342926890725],[37.65232553453667,55.895914914057094],[37.654535674764766,55.895722005317296],[37.657840156271014,55.895444697316265],[37.66053219384062,55.89527894518543],[37.66289115541603,55.89510920342693],[37.66632438295514,55.89494643334027],[37.66859889619955,55.89485600522165],[37.672300344640234,55.89478366257437],[37.67458558672093,55.89470529122028],[37.67593742006442,55.89467514834943],[37.68203139894617,55.89448223341291],[37.68761039369736,55.89433754658317],[37.69133329981,55.8942531456824],[37.69433737390674,55.894096400656515],[37.695978885823784,55.89395774107092],[37.697438007527936,55.89375276511968],[37.69875765436316,55.89354175932823],[37.70023823373939,55.89326443567836],[37.701686626607355,55.89292682159209],[37.70381093614711,55.892323931951346],[37.70694375627651,55.89123870689742],[37.709422117406234,55.8901353635145],[37.711546426945986,55.889176695331486],[37.7130806505025,55.88842300867845],[37.71566629999305,55.887084424941435],[37.71783352487689,55.88597493301006],[37.71924973123682,55.88525133416013],[37.720472818547506,55.88466038504998],[37.72353053682451,55.88302015241735],[37.72583723657741,55.881814054609116],[37.72904515855931,55.88029431778231],[37.73153424852483,55.87911225894809],[37.73414135568752,55.87781557120162],[37.7388727723897,55.87531857090729],[37.74327159517417,55.87305665607454],[37.74610400789386,55.87162102549243],[37.7475416719258,55.87086699648555],[37.75254130952951,55.86827302441227],[37.75741220110056,55.86581763939968],[37.76972890489708,55.859470320071516],[37.78537154787177,55.85142003522694],[37.80335583221299,55.84215044725326],[37.82612242233132,55.83038903380402],[37.829791684263775,55.82845663244996],[37.83167995940998,55.82717636346126],[37.834061761015484,55.82520756536439],[37.83549942504747,55.82360104861357],[37.83708729278415,55.821209268667076],[37.83790268432452,55.81917976382707],[37.83835329543914,55.8164977550844],[37.839383263700974,55.8083056061094],[37.83953118609483,55.80681411140523],[37.839595559111196,55.804638830000265],[37.84006762789793,55.80010660168187],[37.84133363055277,55.78870721671531],[37.84244942950305,55.77860453769166],[37.84279275225684,55.77550851642569],[37.84306097315836,55.77333147859401],[37.84311072472271,55.77262489966423],[37.84321801308329,55.771052489977386],[37.84311072472271,55.76822199203654],[37.84289614800163,55.76408473915383],[37.84257428291989,55.75744243752721],[37.84220950249362,55.750339120332384],[37.84186617974003,55.74420284161639],[37.84165160301856,55.740535135408216],[37.84126536492046,55.73758135136218],[37.840793296133675,55.733561907583386],[37.840373403211956,55.730044340053354],[37.84000862278598,55.72678702246468],[37.83942926563867,55.721870256791945],[37.8390644852127,55.71930263452849],[37.838871366163595,55.71734046927693],[37.83865678944252,55.71587483682374],[37.83844221272128,55.71466352865013],[37.83801305927899,55.713403728133265],[37.83415067829742,55.705856184174095],[37.831532842298756,55.7009731245633],[37.830867654463276,55.69966440894498],[37.83037412800452,55.698537424119515],[37.829944974562075,55.6974346439319],[37.829322702070456,55.69469573601207],[37.82925832905401,55.692902010465104],[37.82942999043129,55.69063549580255],[37.82963383831637,55.689962788243534],[37.82983768620147,55.68870824851983],[37.83224225343624,55.68193071854709],[37.83563256563106,55.67310383805467],[37.83915162385859,55.66323185280024],[37.839709523333845,55.66109704063388],[37.839537861956664,55.657894603122635],[37.83906579316989,55.65619623403459],[37.838121655596964,55.65427941433268],[37.8356754809753,55.651003618210645],[37.83391595186162,55.64945055201769],[37.81567693056034,55.63746074068899],[37.79936909974971,55.62682701509224],[37.796021702899154,55.6246416440357],[37.78971314729615,55.62121764999886],[37.78658032716682,55.61961482617685],[37.7824604541198,55.617501912390054],[37.772976163043204,55.61220698242109],[37.76074528993518,55.60550227945911],[37.75555253328227,55.602611128446966],[37.75306344331652,55.60134770114899],[37.734438183916986,55.59342605263457],[37.7317345172301,55.59228384198964],[37.7290737658872,55.591287418201716],[37.72731423677368,55.590461096276385],[37.722336056841876,55.588419520129854],[37.715898755206254,55.5857944797976],[37.68976331056518,55.57609488508367],[37.68697381318965,55.575025108252326],[37.68427014650265,55.57414981452831],[37.68148064912716,55.57332313024168],[37.678562405718665,55.57249642847739],[37.67706036867056,55.57222896239986],[37.6758158236877,55.57205875576165],[37.67191052736189,55.57157244699275],[37.66976476015013,55.571499500150566],[37.66663194002066,55.57147518450836],[37.664657834185746,55.57154813138976],[37.64401555360707,55.57278820754827],[37.60642171205431,55.5750007947842],[37.60195851625365,55.57526824190241],[37.597495320452786,55.57548706091117],[37.594705823077305,55.57570587869523],[37.593160870684606,55.5760219466599],[37.59195924104606,55.57614351058349],[37.58998513521102,55.576508200087105],[37.58565068544302,55.577480688799525],[37.54792809785753,55.586523675323264],[37.51750111879247,55.59381488264052],[37.51402497590923,55.594835543107756],[37.510935071124266,55.596074880687944],[37.50844598115824,55.59719268086359],[37.50479817689815,55.59957397459323],[37.50187993348991,55.602198089354886],[37.48831868471073,55.613737242320894],[37.47527242006213,55.62493303384076],[37.465873959674056,55.63296968036726],[37.44823535692259,55.64805011604785],[37.4388798118788,55.65574231765956],[37.433901631946895,55.66032779775557],[37.43038257371967,55.66411223210635],[37.42900928270372,55.6661498522404],[37.41847825468055,55.6800079278159],[37.41594624937056,55.684008662313],[37.41530251920699,55.68575430856171],[37.414487127666185,55.687524120011524],[37.41289925992956,55.69023929078387],[37.41071057737334,55.69268763063493],[37.40603280485129,55.696250780832955],[37.396677259807454,55.70315800005127],[37.39088368833526,55.707495591707456],[37.388094190959926,55.709991305171954],[37.386892561321126,55.711663101345266],[37.38427472532264,55.715902841932945],[37.380841497783585,55.72302456586821],[37.378481153850416,55.72757790982341],[37.374532942180544,55.735375483623535],[37.37178636014932,55.74082317056014],[37.37028432310076,55.7436798744616],[37.36916852415064,55.74764985991964],[37.368825201396824,55.75011879260463],[37.36908269346232,55.75508038863393],[37.369211439494876,55.76282405226987],[37.369297270183395,55.7694533371536],[37.369554762248896,55.77758113407221],[37.36985516965845,55.78309545552024],[37.37062764585471,55.78548958793037],[37.371745712245016,55.788519027508144],[37.37432063289931,55.79178326048408],[37.377453453028714,55.79446697959765],[37.381058341944716,55.7982142045865],[37.38406241604141,55.80152596650022],[37.38543570705703,55.803169655694965],[37.38689482876113,55.805345019538734],[37.38788188167862,55.80744775522453],[37.38882601925185,55.8101787243955],[37.38959849544813,55.812353694925015],[37.39537712132244,55.83140488639904]]]};
	var real_mkad = [];
	
	// переворачиваем координаты
	mkad.coordinates[0].forEach(function(item, i, arr) {
	  real_mkad.push([item[1], item[0]]);
	});
	mkad.coordinates[0] = real_mkad;
	
	// Добовляем координаты, что бы сделать "бублик"
	a107.coordinates[1] = real_mkad;
	real_mkad = [];
	a107.coordinates[0].forEach(function(item, i, arr) {
	  real_mkad.push([item[1], item[0]]);
	});
	a107.coordinates[0] = real_mkad;
	
	
	
    ymaps.ready(init);
    function init(){ 
		// Рублей за км доставки
		var rub_km = 49;
	  
		// Инициализируем карту
        var myPlacemark, myMap = new ymaps.Map("map", {
            center: [55.76, 37.64],
            zoom: 9
        }, {
            searchControlProvider: 'yandex#search'
        });
		
		// Отмечаем пункт самовывоза
		myMap.geoObjects.add(new ymaps.Placemark([55.752556, 37.770349], {
            balloonContent: 'г. Москва, 3-й Проезд Перова Поля д.4Ас3<br>Режим работы: Пн-Пт с 10.00 до 18.00, Сб-Вс выходной',
            iconCaption: 'Пункт самовывоза'
        }, {
            preset: 'islands#greenDotIconWithCaption'
        }));
		
		// Очерчивем мкад
		var mkadGeoObject = new ymaps.GeoObject({
			geometry: mkad,
			properties:{
				balloonContent: "Доставка по Москве в пределах МКАД<br> бесплатно от 3000 рублей"
			}
		}, {
			fillColor: '#00AA00',
			strokeColor: '#00AA00',
			opacity: 0.2,
			strokeWidth: 2,
			strokeStyle: 'solid'
		});
		myMap.geoObjects.add(mkadGeoObject);
		
		// Очерчивем A107
		var a107GeoObject = new ymaps.GeoObject({
			geometry: a107,
			// Описываем свойства геообъекта.
			properties:{
				// Содержимое балуна.
				//balloonContent: "Доставка по рублей 40руб/км."
			}
		}, {
			fillColor: '#AA0000',
			strokeColor: '#AA0000',
			opacity: 0.1,
			strokeWidth: 3,
			strokeStyle: 'solid'
		});
		myMap.geoObjects.add(a107GeoObject);
		
		
		// Слушаем клик на карте.
		myMap.events.add('click', function (e) {
			actionClick(e);
		});
		// И по бублику
		a107GeoObject.events.add('click', function (e) {
			actionClick(e);
		});
		
		// и переопределяем по geocode
		element = document.querySelector("#ym-address-calc");
		element.onclick = function(e) {
			var addr = document.querySelector("#ym-address").value;
			if(addr) {
			
				console.log(addr);
			
				ymaps.geocode(addr).then(function (res) {
					var firstGeoObject = res.geoObjects.get(0),
					// Координаты геообъекта.
					coords = firstGeoObject.geometry.getCoordinates(),
					// Область видимости геообъекта.
					bounds = firstGeoObject.properties.get('boundedBy');
					
					// Если метка уже создана – просто передвигаем ее.
					if (myPlacemark) {
						myPlacemark.geometry.setCoordinates(coords);
					}
					// Если нет – создаем.
					else {
						myPlacemark = createPlacemark(coords);
						myMap.geoObjects.add(myPlacemark);
						// Слушаем событие окончания перетаскивания на метке.
						myPlacemark.events.add('dragend', function () {
							getAddress(myPlacemark.geometry.getCoordinates());
						});
					}
					getAddress(coords);
						
				});
				
			}
		};
		
		
		// Обработка события по клику
		function actionClick(e) {
			var coords = e.get('coords');
				// Если метка уже создана – просто передвигаем ее.
				if (myPlacemark) {
					myPlacemark.geometry.setCoordinates(coords);
				}
				// Если нет – создаем.
				else {
					myPlacemark = createPlacemark(coords);
					myMap.geoObjects.add(myPlacemark);
					// Слушаем событие окончания перетаскивания на метке.
					myPlacemark.events.add('dragend', function () {
						getAddress(myPlacemark.geometry.getCoordinates());
					});
				}
				getAddress(coords);
		}

		// Создание метки.
		function createPlacemark(coords) {
			return new ymaps.Placemark(coords, {
				iconCaption: 'Доставка'
			}, {
				preset: 'islands#violetDotIconWithCaption',
				draggable: true
			});
		}

		// Определяем адрес по координатам (обратное геокодирование).
		function getAddress(coords) {
			myPlacemark.properties.set('iconCaption', 'Доставка');
			findClosestObjects(myPlacemark);
			
			
			/**/
		};
		
		
		
		function findClosestObjects(myPlacemark){
			var point = myPlacemark, closestPoint;
		    
			closestPoint = mkadGeoObject.geometry.getClosest(point);
		
			normalVec = new ymaps.Polyline([        
				mkadGeoObject.geometry.getClosest(myPlacemark.geometry.getCoordinates()).position,        
				myPlacemark.geometry.getCoordinates()
			]);
			
			var d = ymaps.coordSystem.geo.getDistance(
				mkadGeoObject.geometry.getClosest(myPlacemark.geometry.getCoordinates()).position,
				myPlacemark.geometry.getCoordinates()
			);
			
			// Визуализация путей.
			//myMap.geoObjects.add(normalVec);
			
			
			var in_poly = a107GeoObject.geometry.contains(myPlacemark.geometry.getCoordinates());
			var in_poly_mkad = mkadGeoObject.geometry.contains(myPlacemark.geometry.getCoordinates());
			
			if(in_poly) {
				myPlacemark.properties.set('iconCaption', "Доставка: "+(Math.round(d / 1000) * rub_km) + "руб.");
				//console.log( Math.round(d / 1000) + "км", in_poly,(Math.round(d / 1000) * rub_km) + "руб." );
			} else {
				if(in_poly_mkad) {
					//console.log("Доставка по Москве в пределах МКАД<br> бесплатно от 3000 рублей");
					myPlacemark.properties.set('iconCaption', 'Бесплатно от 3000 руб.');
				} else {
					//console.log("Доставка не осуществляется.");
					myPlacemark.properties.set('iconCaption', 'Стоимость доставки уточняйте у менеджера');
				}
			}
		}
		
		
		
	}
</script>